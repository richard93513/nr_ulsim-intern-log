# 5G NR LDPC Decoder â€” From OAI to MATLAB

## ç ”ç©¶èƒŒæ™¯

ç‚ºæ·±å…¥ç†è§£ **3GPP 5G NR** è¦ç¯„ä¸­çš„ LDPC è§£ç¢¼æµç¨‹ï¼Œæˆ‘å¾ž OpenAirInterface (OAI) é–‹æºå°ˆæ¡ˆä¸­çš„ `nrLDPC_decoder.c` é€²è¡Œåˆ†æžï¼Œä¸¦å˜—è©¦ç”¨ MATLAB é‡å»ºè§£ç¢¼æµç¨‹ï¼Œä»¥é©—è­‰èˆ‡å­¸ç¿’æ¼”ç®—æ³•ç´°ç¯€ã€‚

---

## ä¸€ã€OAI åŽŸå§‹ç¢¼åˆ†æžé‡é»ž

- ä¸»è¦æª”æ¡ˆï¼š
  - `nrLDPC_decoder.c`ï¼šLDPC è§£ç¢¼ä¸»ç¨‹å¼
  - `ldpctest.c`ï¼šæ¸¬è©¦ç¨‹å¼ï¼Œå«éš¨æ©Ÿè³‡æ–™ç”¢ç”Ÿã€ç·¨ç¢¼ã€èª¿è®Šã€AWGN é€šé“ã€è§£ç¢¼åŠéŒ¯èª¤çŽ‡è¨ˆç®—

- è§£ç¢¼æ ¸å¿ƒæµç¨‹ï¼š
  1. åˆå§‹åŒ–ï¼ˆé¸æ“‡ BaseGraph BG1/BG2ã€lifting size Zã€ç¢¼çŽ‡ç­‰ï¼‰
  2. Min-Sum è¿­ä»£è§£ç¢¼
     - CNï¼ˆCheck Nodeï¼‰è¨Šæ¯æ›´æ–°
     - BNï¼ˆBit Nodeï¼‰è¨Šæ¯æ›´æ–°
     - Parity check é©—è­‰
     - ç¡¬åˆ¤æ±ºï¼ˆhard decisionï¼‰
     - åœæ­¢æ¢ä»¶åˆ¤æ–·ï¼ˆCRC æˆ–æœ€å¤§è¿­ä»£æ•¸ï¼‰
  3. SIMD åŠ é€Ÿï¼ˆAVX512 / AVX2 / baselineï¼‰

---

## äºŒã€å¾ž OAI æµç¨‹æŽ¨å°Ž MATLAB å¯¦ä½œ

### 1. éš¨æ©Ÿè¼¸å…¥ç”¢ç”Ÿ

```matlab
N = 8448;  % ç¯„ä¾‹ Transport Block Size
input_bits = randi([0 1], N, 1);
```
### 2. é¸æ“‡ BaseGraph (BG1 / BG2)
- æ ¹æ“š 3GPP TS 38.212 è¦å®šï¼Œä»¥è³‡è¨Šé•·åº¦èˆ‡ç¢¼çŽ‡åˆ¤å®šï¼š

  - BG1 é©ç”¨æ–¼è³‡è¨Šé•·åº¦å¤§æ–¼æˆ–ç­‰æ–¼ 3840 bits

  - BG2 é©ç”¨æ–¼è¼ƒçŸ­è³‡è¨Šé•·åº¦

### 3. å»ºæ§‹ H_base çŸ©é™£
- H_base ç‚º LDPC çŸ©é™£çš„åŸºç¤Žçµæ§‹ï¼Œå°ºå¯¸ä¾‹ï¼š

  - BG1ï¼š46 x 68 base matrix

  - æ¯å€‹å…ƒç´ ç‚º lifting size Z çš„å³å¾ªç’°ç§»ä½é‡ï¼Œ-1 è¡¨ç¤ºé›¶çŸ©é™£ï¼ˆç©ºç™½ï¼‰

- ä¾ç…§ 3GPP æ¨™æº–è¡¨æ ¼ï¼Œå°‡å„ row èˆ‡ column index å°æ‡‰çš„åç§»å€¼å¡«å…¥ï¼Œå½¢æˆæ•´é«”è§£ç¢¼éª¨æž¶ã€‚
- æˆ‘æˆåŠŸå®Œæˆäº† BG1 ç¬¬ 0 è¡Œçš„ MATLAB ç¨‹å¼ç¢¼å»ºæ§‹ï¼Œç¯„ä¾‹å¦‚ä¸‹ï¼š
```matlab
clear; clc;
% æ‰€æœ‰ column indexï¼ˆrow=0 è³‡æ–™ä¸­æœ‰è³‡æ–™çš„é‚£äº›ï¼‰
col_index_list = [0, 1, 2, 3, 5, 6, 9, 10, 11, 12, 13, 15, 16, 18, 19, 20, 21, 22, 23];

% æ¯å€‹ column index å°æ‡‰çš„ set indexï¼ˆshift æ•¸å€¼ï¼Œ8 å€‹ä¸€çµ„ï¼‰
col_shift_values = [
    250, 307,  73, 223, 211, 294,   0, 135;   % col 0
     69,  19,  15,  16, 198, 118,   0, 227;   % col 1
    226,  50, 103,  94, 188, 167,   0, 126;   % col 2
    159, 369,  49,  91, 186, 330,   0, 134;   % col 3
    100, 181, 240,  74, 219, 207,   0,  84;   % col 5
     10, 216,  39,  10,   4, 165,   0,  83;   % col 6
     59, 317,  15,   0,  29, 243,   0,  53;   % col 9
    229, 288, 162, 205, 144, 250,   0, 225;   % col 10
    110, 109, 215, 216, 116,   1,   0, 205;   % col 11
    191,  17, 164,  21, 216, 339,   0, 128;   % col 12
      9, 357, 133, 215, 115, 201,   0,  75;   % col 13
    195, 215, 298,  14, 233,  53,   0, 135;   % col 15
     23, 106, 110,  70, 144, 347,   0, 217;   % col 16
    190, 242, 113, 141,  95, 304,   0, 220;   % col 18
     35, 180,  16, 198, 216, 167,   0,  90;   % col 19
    239, 330, 189, 104,  73,  47,   0, 105;   % col 20
     31, 346,  32,  81, 261, 188,   0, 137;   % col 21
      1,   1,   1,   1,   1,   1,   0,   1;   % col 22
      0,   0,   0,   0,   0,   0,   0,   0    % col 23
];

% åˆå§‹åŒ– H_base_row ç‚º -1
H_base_row = -1 * ones(1, 544);  % 68*8

% å°‡æœ‰å®šç¾©çš„ shift å¡«å…¥å°æ‡‰ä½ç½®
for k = 1:length(col_index_list)
    col = col_index_list(k);
    shifts = col_shift_values(k, :);  % å°æ‡‰çš„ shift æ•¸å€¼
    for i = 0:7
        idx = col * 8 + i + 1;  % MATLAB index èµ·å§‹ç‚º 1
        H_base_row(idx) = shifts(i+1);
    end
end
```
- col_index_listï¼šåªåˆ—å‡ºé€™è¡Œä¸­æœ‰å®šç¾©çš„ column indexï¼ˆéžç©ºç™½ï¼‰

- col_shift_valuesï¼šæ¯å€‹ column ä¸‹ï¼Œ8 å€‹ set index çš„ shift å€¼ï¼ˆå°æ‡‰ 5G NR LDPC base graph è£¡çš„ cyclic shiftï¼‰

- H_base_rowï¼šä»£è¡¨è©²è¡Œå°æ‡‰å®Œæ•´ 68 å€‹ columnï¼Œæ¯å€‹ column æœ‰ 8 å€‹ set indexï¼Œæ‰€ä»¥é•·åº¦æ˜¯ 68*8=544
æ²’å®šç¾©çš„ä½ç½®ç”¨ -1 è¡¨ç¤ºç©ºç™½ï¼ˆç„¡é‚Šé€£æŽ¥ï¼‰

- for è¿´åœˆï¼šä¾ç…§ column å’Œ set index è¨ˆç®—ä½ç½®ï¼Œæ”¾å…¥å°æ‡‰çš„ shift å€¼
### 4. Min-Sum è§£ç¢¼æž¶æ§‹
```matlab
% åˆå§‹åŒ–è¨Šæ¯
LLR = received_llr;  % å¾žé€šé“è¼¸å…¥çš„ log-likelihood ratio

for iter = 1:max_iterations
    % CN æ›´æ–°
    % BN æ›´æ–°
    % ç¡¬åˆ¤æ±ºä¸¦ parity check
    if parity_check_passed
        break;
    end
end
```
## ä¸‰ã€H_base å»ºæ§‹ç´°ç¯€
- åŽŸå§‹è³‡æ–™ä»¥ row èˆ‡ column ç‚ºç´¢å¼•ï¼Œå°æ‡‰å¤šå€‹ set index (0~7)

- é€éŽ MATLAB å°‡æ¯å€‹ row èˆ‡ column ä¸‹çš„ set index åŠåç§»é‡æ˜ å°„è‡³å®Œæ•´çš„ parity check matrix

- åˆ©ç”¨ lifting size Z å°‡ base matrix æ“´å±•æˆå®Œæ•´å¤§å°

## å››ã€æ•´é«”è§£ç¢¼æµç¨‹åœ–

![Untitled diagram _ Mermaid Chart-2025-07-01-181634](https://github.com/user-attachments/assets/a6e66335-e354-471e-b0df-d113e55a3106)

## äº”ã€å¿ƒå¾—èˆ‡æœªä¾†è¦åŠƒ
- H_base æ˜¯ç†è§£èˆ‡å¯¦ä½œ LDPC è§£ç¢¼æœ€é—œéµçš„éƒ¨åˆ†

- ç”± 3GPP æ¨™æº–ç´°ç¯€æ•´ç† base graphï¼Œæ­é… MATLAB å¯é‚„åŽŸæ•´é«”è§£ç¢¼æµç¨‹

- å¾ŒçºŒè¨ˆç•«ï¼š

  - å®Œæ•´å±•é–‹ lifting çŸ©é™£ä¸¦é©—è­‰è§£ç¢¼æ­£ç¢ºæ€§

  - åŠ å…¥ CRC æ—©åœæ©Ÿåˆ¶

  - å¯¦ä½œ BER æ¸¬è©¦ä¸¦èˆ‡ OAI çµæžœæ¯”å°

  - æŽ¢ç´¢ SIMD åŠ é€Ÿåœ¨ MATLAB çš„æ¨¡æ“¬å¯èƒ½æ€§

# 5G NR LDPC Base Graph 1 æ“´å±•ç­†è¨˜
## 1. Base Graph BG1 çµæ§‹
- 5G NR ä¸­çš„ LDPC ä½¿ç”¨å…©ç¨® Base Graphï¼ˆBG1 èˆ‡ BG2ï¼‰ã€‚

- æœ¬æ¬¡ç ”ç©¶çš„æ˜¯ BG1ï¼Œå…¶çŸ©é™£å¤§å°ç‚ºï¼š
  
  46 Ã— 68
  
  è¡¨ç¤ºæœ‰ 46 å€‹ check node å€å¡Šã€68 å€‹ variable node å€å¡Šã€‚

## 2. Set Index èˆ‡ä½ç§»é‡çš„ç†è§£
- åœ¨ 3GPP è¦æ ¼ï¼ˆå¦‚ TS 38.212ï¼‰ä¸­ï¼ŒBG1 çš„æ¯å€‹å…ƒç´ æœ€å¤šåŒ…å« 8 æ¢é‚Šï¼ˆSet Index 0~7ï¼‰ã€‚

- æ¯å€‹ set index å°æ‡‰ä¸€å€‹ä½ç§»é‡ï¼Œç‚ºä¸€å€‹æ•´æ•¸ï¼š

  - -1 è¡¨ç¤ºä¸ä½ç§»

  - 0 ~ Zâˆ’1 è¡¨ç¤ºå³ç§»å¤šå°‘å–®ä½

- æ¯å€‹ä½ç½®å¯ä»¥æœ‰å¤šå€‹ shift å€¼ï¼Œå¯¦éš›ä»£è¡¨å¤šæ¢ check-variable é‚Šã€‚

## 3. å£“ç¸®çŸ©é™£å»ºç«‹èˆ‡å±•é–‹åŽŸç†
### å£“ç¸®çŸ©é™£å»ºç«‹
- OAI åŽŸå§‹ç¢¼å°‡ BG1 æ‹†ç‚º 8 å€‹çŸ©é™£ï¼ˆBG1_I0 ~ BG1_I7ï¼‰ï¼Œæ¯å€‹éƒ½æ˜¯ 46Ã—68
  - ç¶²å€:https://gitlab.eurecom.fr/oai/openairinterface5g/-/tree/develop/openair1/PHY/CODING/nrLDPC_decoder_LYC/bgs
- ç¨‹å¼ä¸­å°‡é€™ 8 å€‹çŸ©é™£é€å€‹ä¾æ¬„ä½æ‹¼æŽ¥ï¼Œè®Šæˆä¸€å€‹ 46Ã—544 çš„å¤§çŸ©é™£ï¼š

```matlab

BG1_I0=[];
BG1_I1=[];
......
BG1_I7=[];
for row = 1:46
    for col = 1:68
        for block = 0:7
            varName = sprintf('BG1_I%d', block);         % çµ„å‡ºè®Šæ•¸å BG1_Ix
            H_col = (col - 1)*8 + block + 1;              % è¨ˆç®—å£“ç¸®çŸ©é™£çš„æ¬„ä½ä½ç½®
            H(row, H_col) = eval([varName '(' num2str(row) ',' num2str(col) ')']);
        end
    end
end
```
- çµæžœçŸ©é™£ H å³ç‚ºå£“ç¸®æ ¼å¼ï¼Œå¤§å°ç‚ºï¼š
46 Ã— 544  = 46 Ã— (68Ã—8)
### å±•é–‹åŽŸç†
- æ¯å€‹ BG1(ð‘–,ð‘—) ä½ç½®å¯¦éš›åŒ…å« 8 å€‹ set index å°æ‡‰çš„ shift å€¼

- å±•é–‹æ™‚ï¼Œå°æ¯å€‹ shift å€¼å»ºç«‹ä¸€å€‹å¤§å°ç‚º ZÃ—Z çš„å–®ä½çŸ©é™£ï¼Œå³å¾ªç’°ä½ç§»æŒ‡å®šæ¬¡æ•¸

- 8å€‹ shift çµæžœç›¸åŠ ï¼ˆmod 2ï¼‰å¾Œï¼Œæ”¾å…¥å¤§çŸ©é™£çš„å°æ‡‰å€å¡Šä¸­

- æœ€çµ‚ç”Ÿæˆçš„ parity check matrix å¤§å°ç‚ºï¼š(46 Ã— Z) Ã— (68 Ã— Z)

## 4. å±•é–‹ç¨‹å¼è§£é‡‹ï¼ˆexpand_ldpc_H_multi_shiftï¼‰
```matlab
function H_expanded = expand_ldpc_H_multi_shift(H_compact, Z)
% å±•é–‹ LDPC å£“ç¸®çŸ©é™£ï¼ˆæ¯å€‹ä½ç½®æœ€å¤š 8 å€‹ shiftï¼‰æˆå®Œæ•´ H çŸ©é™£
%
% è¼¸å…¥ï¼š
%   H_compact - å¤§å°ç‚º 46Ã—544 çš„çŸ©é™£ï¼ˆå³ 68Ã—8ï¼Œæ¯å€‹ä½ç½®æœ€å¤šæœ‰ 8 å€‹ shiftï¼‰
%   Z         - lifting sizeï¼ˆå¦‚ Z = 384ï¼‰
%
% è¼¸å‡ºï¼š
%   H_expanded - å±•é–‹å¾Œçš„ (46Ã—Z) Ã— (68Ã—Z) çš„ç¨€ç–çŸ©é™£ï¼ˆå…¨éƒ¨ç”± 0/1 çµ„æˆï¼‰

    edges_per_pos = 8;  % æ¯å€‹ base graph ä½ç½®æœ€å¤šå„²å­˜ 8 å€‹ shiftï¼ˆå°æ‡‰ 8 æ¢é‚Šï¼‰

    [rows_bg, ~] = size(H_compact);  % rows_bg = 46ï¼Œå°æ‡‰ base graph çš„åˆ—æ•¸ï¼ˆæª¢æŸ¥ç¯€é»žæ•¸ï¼‰
    cols_bg = 68;  % å›ºå®šç‚º BG1 çš„æ¬„æ•¸ï¼ˆè®Šæ•¸ç¯€é»žå€å¡Šæ•¸ï¼‰

    % å»ºç«‹ç©ºçš„ç¨€ç–çŸ©é™£ï¼Œå¤§å°ç‚º (46Ã—Z) Ã— (68Ã—Z)
    % æ¯å€‹ base graph çš„å…ƒç´ æœƒè¢«å±•é–‹ç‚ºä¸€å€‹ ZÃ—Z å­çŸ©é™£
    H_expanded = sparse(rows_bg * Z, cols_bg * Z);

    % å¤–å±¤è¿´åœˆï¼šå¾žç¬¬ 1 åˆ—è·‘åˆ°ç¬¬ 46 åˆ—ï¼ˆå°æ‡‰ base graph çš„è¡Œï¼‰
    for i = 1:rows_bg
        % ä¸­å±¤è¿´åœˆï¼šå¾žç¬¬ 1 è¡Œè·‘åˆ°ç¬¬ 68 è¡Œï¼ˆå°æ‡‰ base graph çš„åˆ—ï¼‰
        for j = 1:cols_bg
            % å–å¾—é€™å€‹ä½ç½®ä¸Šæ‰€æœ‰çš„ shift indexï¼ˆå…±æœ€å¤š 8 å€‹ï¼‰
            % H_compact(i, (j-1)*8+1 : j*8) å°±æ˜¯è©²ä½ç½®çš„ 8 å€‹ shift å€¼
            shifts = H_compact(i, (j-1)*edges_per_pos + (1:edges_per_pos));

            % åˆå§‹åŒ–ä¸€å€‹ ZÃ—Z çš„å…¨é›¶çŸ©é™£ï¼Œæº–å‚™æŠŠå¤šå€‹å¾ªç’°çŸ©é™£ç–ŠåŠ èµ·ä¾†
            submat = zeros(Z,Z);

            % å…§å±¤è¿´åœˆï¼šæœ€å¤š 8 å€‹ shift indexï¼Œä¾åºç–ŠåŠ å°æ‡‰çš„å¾ªç’°ä½ç§»å–®ä½çŸ©é™£
            for k = 1:edges_per_pos
                shift_val = shifts(k);  % å–å¾—ç¬¬ k æ¢é‚Šçš„ä½ç§»é‡
                if shift_val >= 0 && shift_val < Z
                    % å»ºç«‹ä¸€å€‹å³ç§» shift_val çš„å–®ä½çŸ©é™£ï¼Œä¸¦èˆ‡ submat åš XOR ç–ŠåŠ 
                    submat = mod(submat + circshift(eye(Z), [0, shift_val]), 2);
                end
            end

            % è¨ˆç®—å±•é–‹å¾Œé€™ä¸€å¡Š ZÃ—Z å­çŸ©é™£åœ¨å¤§çŸ©é™£ä¸­çš„ row ç¯„åœ
            row_idx = (i-1)*Z + (1:Z);
            % è¨ˆç®—å±•é–‹å¾Œé€™ä¸€å¡Š ZÃ—Z å­çŸ©é™£åœ¨å¤§çŸ©é™£ä¸­çš„ column ç¯„åœ
            col_idx = (j-1)*Z + (1:Z);

            % æŠŠçµ„åˆå¥½çš„ ZÃ—Z å­çŸ©é™£æ”¾å…¥å°æ‡‰çš„å¤§çŸ©é™£å€å¡Šä¸­
            H_expanded(row_idx, col_idx) = submat;
        end
    end
end

% ä¸»ç¨‹å¼é–‹å§‹
Z = 384;  % è¨­å®š lifting sizeï¼Œå¿…é ˆ â‰¥ æœ€å¤§ shift index æ‰åˆæ³•ï¼ˆæ­¤ä¾‹é…åˆ 5G NR BG1ï¼‰

H = nr5g_ldpc_H_BG1_Z384();  % è¼‰å…¥ 46Ã—544 çš„ base graph shift index çŸ©é™£ï¼ˆä½ è‡ªå·±å¯«çš„ functionï¼‰

H_expanded = expand_ldpc_H_multi_shift(H, Z);  % å°‡å£“ç¸®çš„ shift index çŸ©é™£å±•é–‹ç‚ºçœŸæ­£çš„ parity check matrix

% é¡¯ç¤ºå±•é–‹å¾ŒçŸ©é™£çš„å¤§å°ï¼ˆæ‡‰ç‚º 17664 Ã— 26112ï¼‰
fprintf("H_expanded size: %d x %d\n", size(H_expanded,1), size(H_expanded,2));

% ç•«å‡ºå±•é–‹å¾Œçš„ç¨€ç–çŸ©é™£çµæ§‹åœ–
spy(H_expanded); 
title('å±•é–‹å¾Œçš„ H çŸ©é™£ (Z=384)');
```

å‡½å¼è¼¸å…¥ï¼š

- H_compactï¼š46Ã—544 çš„å£“ç¸® shift çŸ©é™£

- Zï¼šlifting sizeï¼ˆå¦‚ Z = 384ï¼‰

å‡½å¼è¼¸å‡ºï¼š

- H_expandedï¼šå¯¦éš›è§£ç¢¼ç”¨çš„ LDPC parity check matrixï¼Œå¤§å°ç‚º (46Ã—Z) Ã— (68Ã—Z)

ä¸»è¦æµç¨‹ï¼š

1.å°æ¯å€‹ base graph å…ƒç´ æå–å…¶ 8 å€‹ shift å€¼

2.æ¯å€‹ shift å€¼ç”¢ç”Ÿä¸€å€‹å³ç§»çš„å–®ä½çŸ©é™£

3.å¤šå€‹ shift çµæžœé€²è¡Œ XOR ç–ŠåŠ 

4.æ”¾å…¥å±•é–‹å¾ŒçŸ©é™£çš„å°æ‡‰ ZÃ—Z å€å¡Šä½ç½®

5.å…¨éƒ¨ä»¥ sparse æ ¼å¼å„²å­˜ï¼Œç¯€çœè¨˜æ†¶é«”

## 5. æª¢æŸ¥èˆ‡é©—è­‰
- å±•é–‹å¾Œçš„çŸ©é™£å¤§å°ç‚ºï¼š
17664 Ã— 26112ï¼ˆå°æ‡‰ Z = 384ï¼‰

- å¯ä½¿ç”¨ä»¥ä¸‹æ–¹å¼ç¢ºèªæ­£ç¢ºæ€§ï¼š

  - size(H_expanded)
    ```matlab
    H_expanded size: 17664 x 26112
    ```
  - nnz(H_expanded) æŸ¥çœ‹éžé›¶å…ƒç´ å€‹æ•¸

  - spy(H_expanded) è§€å¯Ÿæ•´é«”ç¨€ç–çµæ§‹
     ![untitled](https://github.com/user-attachments/assets/d926ef89-ef2e-4594-8c39-05efe95adfae)

  - full(H_expanded(1:Z,1:Z)) æŸ¥çœ‹ç´°ç¯€å€å¡Š

## 6. çµè«–
é€éŽæ­¤æ–¹æ³•ï¼Œå¯ä»¥å¾ž 3GPP çš„å£“ç¸® shift çŸ©é™£æº–ç¢ºå±•é–‹å‡º LDPC è§£ç¢¼æ‰€éœ€çš„ parity check çŸ©é™£ H_expandedï¼Œ
å¯ç”¨æ–¼å¾ŒçºŒ Min-Sumã€BP ç­‰è§£ç¢¼æµç¨‹ï¼Œç¬¦åˆ 5G NR å¯¦éš›å¯¦ä½œéœ€æ±‚ã€‚

# 2025/07/05 - LDPC æ¨¡æ“¬æµç¨‹å˜—è©¦ç´€éŒ„

## ç›®æ¨™

å»ºç«‹ä¸€å€‹æ¨¡æ“¬æµç¨‹ï¼Œé©—è­‰ 5G NR LDPC Min-Sum è§£ç¢¼å™¨åœ¨ QPSK + AWGN é€šé“ä¸‹çš„éŒ¯èª¤çŽ‡è¡¨ç¾ï¼Œä½¿ç”¨ Base Graph 1ï¼Œå›ºå®š lifting size $Z = 384$ã€‚

---

## ä¸€ã€æ¨¡æ“¬æµç¨‹è¨­è¨ˆèˆ‡åˆå§‹å˜—è©¦

æœ€åˆè¨­è¨ˆçš„æµç¨‹åŒ…æ‹¬ï¼š

1. éš¨æ©Ÿç”¢ç”Ÿè³‡è¨Šä½å…ƒ `bits`ï¼›
2. æœªå¯¦ä½œç·¨ç¢¼ï¼Œç›´æŽ¥è£œ 0 æ¨¡æ“¬ç‚º LDPC codewordï¼›
3. ä½¿ç”¨ QPSK èª¿è®Šï¼›
4. æ·»åŠ  AWGN é›œè¨Šï¼›
5. è¨ˆç®— soft LLRï¼›
6. ä½¿ç”¨å±•é–‹å¾Œçš„æª¢æŸ¥çŸ©é™£ `H` åŸ·è¡Œ Min-Sum è§£ç¢¼ã€‚

### å•é¡Œ

è©²æµç¨‹å®Œå…¨ç„¡æ³•æˆåŠŸå®Œæˆæ¨¡æ“¬ã€‚Min-Sum è§£ç¢¼å™¨ç„¡æ³•æ”¶æ•—ï¼Œç„¡æ³•é€šéŽ parity checkï¼ŒåŽŸå› æ˜¯è¼¸å…¥è¨Šè™Ÿæœªç¶“ LDPC ç·¨ç¢¼ï¼Œå› æ­¤èˆ‡ `H` ä¸ç›¸å®¹ï¼Œé€ æˆè§£ç¢¼å™¨ç„¡æ³•æœ‰æ•ˆé‹ä½œã€‚

---

## äºŒã€å˜—è©¦åŠ å…¥ LDPC ç·¨ç¢¼

é€²ä¸€æ­¥å˜—è©¦è£œä¸Šç·¨ç¢¼æµç¨‹ï¼Œä½¿ç”¨å·²å±•é–‹ä¹‹ `H_expanded_BG1_Z384`ï¼Œé€²è¡Œä¸‹åˆ—æ“ä½œï¼š

* æ‰‹å‹•æ’°å¯« `ldpc_encode_simple()`ï¼Œå˜—è©¦å°‡è³‡è¨Š bits èˆ‡ `H` çŸ©é™£æ±‚ parity bitsï¼›
* å˜—è©¦å°‡ `sparse` è½‰ç‚º `full` ä»¥ä½¿ç”¨ MATLAB `gf` åšè¡Œé‹ç®—ï¼›
* é™ä½Ž SNRã€å‚³è¼¸å€å¡Šæ•¸ã€ç–Šä»£æ¬¡æ•¸ã€‚

### å•é¡Œ

å³ä½¿æ­£ç¢ºåˆ†é›¢ `H = [H1 | H2]`ï¼Œåœ¨é€²è¡Œ dense çŸ©é™£é‹ç®—æ±‚ parity bits æ™‚ï¼Œå›  `H`ç‚º 17664Ã—26112 çš„å¤§çŸ©é™£ï¼Œé€ æˆè¨˜æ†¶é«”èˆ‡é€Ÿåº¦ç’°ç¯€ï¼Œæ¨¡æ“¬ç¨‹å¼åŸ·è¡Œæ•¸å°æ™‚ä»ç„¡æ³•å®Œæˆã€‚

---

## ä¸‰ã€å­¸ç¿’éŽç¨‹ï¼šQPSK LLR èˆ‡ Min-Sum è§£ç¢¼å™¨

å„˜ç®¡æ¨¡æ“¬æµç¨‹ä¸ŠæœªæˆåŠŸåŸ·è¡Œï¼ŒéŽç¨‹ä¸­é‡‹æ¸…äº†ä¸‹åˆ—é—œéµæ¨¡çµ„é‹ä½œæ–¹å¼ï¼š

### QPSK èª¿è®Šèˆ‡ LLR è¨ˆç®—

* æ¯å…©å€‹ bit çµ„æˆä¸€å€‹ symbolï¼Œä½¿ç”¨ Gray Mapping å°æ‡‰è‡³ QPSK æ˜Ÿåº§é»ž {00â†’1+1j, 01â†’-1+1j, 10â†’1-1j, 11â†’-1-1j}ï¼Œä¸¦é™¤ä»¥ $\sqrt{2}$ ä»¥æ­£è¦åŒ–åŠŸçŽ‡ã€‚

* æŽ¥æ”¶ç«¯æ”¶åˆ°ä¸€ä¸²è¤‡æ•¸ç¬¦è™Ÿ $r$ï¼Œæ¯å€‹ symbol å°æ‡‰å…©å€‹ bitï¼Œéœ€é‡å°æ¯ä¸€å€‹ bit è¨ˆç®— soft LLR å€¼ã€‚

* å°æ–¼æ¯å€‹ bitï¼Œå°‡æ‰€æœ‰ QPSK æ˜Ÿåº§é»žåˆ†ç‚ºã€Œè©² bit = 0ã€èˆ‡ã€Œè©² bit = 1ã€çš„å­é›†åˆï¼Œè¨ˆç®—æŽ¥æ”¶åˆ°çš„ç¬¦è™Ÿ $r$ èˆ‡å„å­é›†åˆå…§é»žä¹‹æ­å¹¾é‡Œå¾—è·é›¢å¹³æ–¹ï¼Œåˆ†åˆ¥å–æœ€å°å€¼ï¼š

  $$
  LLR_b = \min_{x: b=0} ||r - x||^2 - \min_{x: b=1} ||r - x||^2
  $$

* æ­¤ç‚º Max-Log approximationï¼Œæä¾›æ¯å€‹ bit çš„ soft decision è³‡è¨Šä¾› LDPC è§£ç¢¼ä½¿ç”¨ã€‚

### Min-Sum è§£ç¢¼æµç¨‹

* é¦–å…ˆä»¥ channel LLR åˆå§‹åŒ– bit node å° check node çš„è¼¸å‡ºè¨Šæ¯ï¼ˆbit-to-check messagesï¼‰ï¼ŒçŸ©é™£å¤§å°èˆ‡ parity-check matrix $H$ ç›¸åŒã€‚

* æ¯æ¬¡ç–Šä»£åŒ…å«ä»¥ä¸‹æ­¥é©Ÿï¼š

  1. **check node æ›´æ–°ï¼ˆCNï¼‰**ï¼šå°æ¯å€‹ check nodeï¼Œé‡å°å…¶é€£æŽ¥çš„æ¯å€‹ bit nodeï¼Œå¾žå…¶ä»–ç›¸é€£çš„ bit node æŽ¥æ”¶çš„è¨Šæ¯ä¸­å–ã€Œç¬¦è™Ÿç©ã€èˆ‡ã€Œæœ€å°çµ•å°å€¼ã€ï¼Œé€å‡ºæ›´æ–°å¾Œçš„è¨Šæ¯çµ¦è©² bit nodeã€‚
  2. **bit node æ›´æ–°ï¼ˆBNï¼‰**ï¼šå°æ¯å€‹ bit nodeï¼Œå°‡ä¾†è‡ªå…¶ä»– check node çš„è¨Šæ¯èˆ‡åŽŸå§‹ channel LLR ç›¸åŠ ï¼Œæ›´æ–°é€å¾€å„ check node çš„è¨Šæ¯ã€‚
  3. **ç¸½ LLR çµåˆ**ï¼šå°æ¯å€‹ bit nodeï¼Œåˆä½µåŽŸå§‹ LLR èˆ‡æ‰€æœ‰ check-to-bit è¨Šæ¯ï¼Œé€²è¡Œç¡¬åˆ¤æ–·ï¼ˆLLR < 0 åˆ¤ç‚º 1ï¼Œå¦å‰‡ 0ï¼‰ã€‚
  4. **æª¢æŸ¥ parity check æ˜¯å¦æ»¿è¶³**ï¼šè‹¥æ‰€æœ‰æª¢æŸ¥ç­‰å¼çš†ç‚º 0ï¼Œææ—©çµæŸè§£ç¢¼ã€‚

* æ­¤æµç¨‹ç‚ºå…¸åž‹ Min-Sum è§£ç¢¼æ¼”ç®—æ³•ï¼Œè¨ˆç®—é‡è¼ƒä½Žä½†ä»å…·å‚™ä¸éŒ¯çš„æ•ˆèƒ½ï¼Œé©ç”¨æ–¼ç¡¬é«”èˆ‡æ¨¡æ“¬å¯¦ä½œã€‚

---

## å››ã€é‡è¦çµè«–èˆ‡å¾ŒçºŒè¦åŠƒ

### é‡è¦ç†è§£

* **LDPC è§£ç¢¼å™¨å¿…é ˆé…åˆå¯¦éš›ç·¨ç¢¼éŽçš„ codeword æ‰èƒ½æ­£ç¢ºé‹ä½œ**ã€‚
* **éš¨æ©Ÿç”¢ç”Ÿè³‡æ–™ç›´æŽ¥è£œ 0 ç„¡æ³•æ»¿è¶³ parity constraintsï¼Œè§£ç¢¼å™¨ä¸€å®šæœƒå¤±æ•—ã€‚**

### å¾ŒçºŒæ–¹å‘

1. æ”¹ç”¨ base graph çµæ§‹å¯¦ä½œ encoderï¼Œé¿å…æ“ä½œå±•é–‹çŸ©é™£ï¼›
2. æ”¹ç”¨ lifting size $Z$ è¼ƒå°çš„ç‰ˆæœ¬é€²è¡Œæ¸¬è©¦ï¼ˆå¦‚ $Z = 64$ï¼‰ï¼›
3. æ¸¬è©¦ OAI ä¸­ `ldpctest` çš„ codeword ç”¢ç”Ÿæ–¹å¼ï¼Œæ˜¯å¦ä»¥æ¨™æº–æµç¨‹é©—è­‰ LDPC ç·¨ç¢¼å™¨èˆ‡è§£ç¢¼å™¨åŠŸèƒ½ï¼›
4. è‹¥ç„¡æ³•æˆåŠŸå¯¦ä½œ encoderï¼Œå¯è€ƒæ…®é å…ˆç”¢ç”Ÿå·²çŸ¥æ­£ç¢ºçš„ LDPC codeword å†è¡Œæ¸¬è©¦ã€‚

# 2025/07/07 - LDPC æ¨¡æ“¬æµç¨‹ å¯¦ä½œèˆ‡é™¤éŒ¯ç´€éŒ„

## ä¸€ã€ç³»çµ±åˆ†å·¥èˆ‡æ¨¡çµ„åŒ–ç¨‹å¼æž¶æ§‹

æ•´é«”å¯¦ä½œåˆ†ç‚ºå…©å€‹ä¸»è¦æ¨¡çµ„ï¼šç™¼é€ç«¯ï¼ˆTxï¼‰èˆ‡æŽ¥æ”¶ç«¯ï¼ˆRxï¼‰ï¼Œæ‰€æœ‰ç¨‹åºçš†ä»¥ MATLAB æ’°å¯«ï¼Œä¸¦ä½¿ç”¨ NR Base Graph 1ï¼Œlifting size ç‚º Z = 384ã€‚

### 1.1 ç™¼é€ç«¯ï¼ˆTxï¼‰æµç¨‹

ç™¼é€ç«¯åŒ…å«ä»¥ä¸‹æ­¥é©Ÿï¼š

1. ç”¢ç”Ÿéš¨æ©Ÿè³‡è¨Šä½å…ƒ `tx_bits`ï¼Œé•·åº¦ç‚º `K = 22 * Z`ã€‚
2. ä½¿ç”¨ `ldpc_encode_neighbor()` å‡½æ•¸ï¼Œé€éŽé„°æŽ¥è¡¨ `cn_to_vn` å°è³‡è¨Šé€²è¡Œç·¨ç¢¼ï¼Œç”¢ç”Ÿé•·åº¦ç‚º `N = 68 * Z` çš„ codewordã€‚
3. ä»¥ Gray ç·¨ç¢¼æ–¹å¼é€²è¡Œ QPSK èª¿è®Šï¼Œç¬¦è™Ÿæ˜ å°„é †åºç‚ºï¼š

   ```
   [1+1j, -1+1j, -1-1j, 1-1j] / sqrt(2)  å°æ‡‰ bit pair ç‚º 00, 01, 11, 10
   ```

   ä½¿ç”¨ bi2de + Gray ç´¢å¼•æ³•å°æ‡‰ã€‚
4. é€šé“åŠ å…¥ AWGN å™ªè²ï¼Œä¸¦ä»¥ SNR = 20 dB æ¨¡æ“¬ã€‚
5. æŽ¥æ”¶ç«¯ä»¥æœ€å°è·é›¢è¿‘ä¼¼æ³•è¨ˆç®—æ¯å€‹ç¬¦è™Ÿå°æ‡‰çš„ soft-bit LLRï¼Œè½‰ç‚º `rx_llr`ã€‚
6. å„²å­˜å¿…è¦æ¨¡æ“¬è³‡æ–™è‡³ `.mat` æª”ï¼š

   ```
   save(filename, 'rx_llr', 'tx_bits', 'snr_db');
   ```

### 1.2 æŽ¥æ”¶ç«¯ï¼ˆRxï¼‰æµç¨‹

æŽ¥æ”¶ç«¯åŒ…å«ä»¥ä¸‹æ­¥é©Ÿï¼š

1. è¼‰å…¥é€šé“è¼¸å‡ºæª”æ¡ˆ `ldpc_channel_output.mat`ã€‚
2. ä½¿ç”¨é„°æŽ¥è¡¨ `cn_to_vn`, `vn_to_cn` å»ºç«‹è§£ç¢¼æµç¨‹ã€‚
3. åŸ·è¡Œ `ldpc_decode_min_sum_neighbor()` ä»¥ Min-Sum æ–¹æ³•è§£ç¢¼ã€‚
4. çµ±è¨ˆéŒ¯èª¤çŽ‡èˆ‡ parity check failure æ•¸ï¼š

   ```
   n_err = sum(decoded(1:K) ~= tx_bits);
   ber = n_err / K;
   ```

---

## äºŒã€è½‰ç”¨é„°æŽ¥è¡¨çš„åŽŸå› èˆ‡å‹•æ©Ÿ

èµ·åˆå˜—è©¦ä»¥å±•é–‹å¾Œçš„ `H_expanded` é€²è¡ŒçŸ©é™£ç·¨ç¢¼ï¼ŒæœŸæœ›æŽ¨å°Žå‡º `H = [P | I]` çµæ§‹ä¸¦å°Žå‡ºç³»çµ±å¼ç”ŸæˆçŸ©é™£ `G = [I | Páµ—]`ã€‚

ä½†å¯¦ä½œä¸­é‡åˆ°é‡å¤§å›°é›£ï¼š

* `H_expanded` ç‚º 17664Ã—26112 çš„ç¨€ç–çŸ©é™£ï¼Œå°å…¶é€²è¡ŒçŸ©é™£åˆ†å¡Šèˆ‡ç§©åˆ¤æ–·ï¼ˆå¦‚ `rank(P)`ï¼‰æ™‚æœƒå‡ºéŒ¯ï¼š

  ```
  Error using svd: SVD does not support sparse matrices.
  ```

* å¼·åˆ¶è½‰ç‚º full matrix é€ æˆè¨˜æ†¶é«”ä¸è¶³æˆ–æ•ˆèƒ½éŽå·®ã€‚

å› æ­¤æ±ºå®š**å…¨é¢æ”¹ç”¨é„°æŽ¥è¡¨æ–¹å¼**ï¼š

* ä½¿ç”¨ `build_neighbor_tables(H)` å°‡ `H` è½‰ç‚º `cn_to_vn` å’Œ `vn_to_cn` çµæ§‹ï¼›
* å¯ç¯€çœå¤§é‡è¨˜æ†¶é«”ï¼Œä¸¦åˆ©æ–¼å»ºæ§‹è§£ç¢¼æµç¨‹ï¼ˆä¾‹å¦‚ message passingï¼‰ã€‚

---

## ä¸‰ã€æ”¹ç”¨é„°æŽ¥è¡¨å¾Œä»ç„¡æ³•æ­£ç¢ºæ”¶æ–‚

åœ¨è½‰ç”¨é„°æŽ¥è¡¨å¾Œï¼Œæ•´é«” Min-Sum è§£ç¢¼æµç¨‹å¾—ä»¥é †åˆ©åŸ·è¡Œï¼š

* è§£ç¢¼å‡½æ•¸ `ldpc_decode_min_sum_neighbor()` å¯æ­£å¸¸é€²è¡Œç–Šä»£ï¼ˆæœ€å¤§é” 300 æ¬¡ï¼‰ï¼›
* ä½†è§€å¯Ÿæ¯è¼ªçš„éŒ¯èª¤ bit æ•¸èˆ‡ parity check æ•¸ï¼Œçš†å‘ˆç¾éœ‡ç›ªä¸”ä¸æ”¶æ–‚ï¼š

  ```
   Iteration 1: 8772
   Iteration 2: 8798
   Iteration 3: 8940
   ...
   Iteration 20: 8830
  ```

å³ä½¿å°‡ SNR æå‡è‡³ 20dBï¼ŒéŒ¯èª¤çŽ‡ä»ç„¶éžå¸¸é«˜ï¼ˆç´„ 0.91ï¼‰ï¼Œæ˜Žé¡¯èˆ‡ç†è«–ä¸ç¬¦ã€‚

---

## å››ã€æ·±å…¥è¿½æŸ¥ï¼šç™¼ç¾æ˜¯ç·¨ç¢¼éŒ¯èª¤è€Œéžè§£ç¢¼éŒ¯èª¤

ç‚ºé©—è­‰ç·¨ç¢¼æ˜¯å¦æ­£ç¢ºï¼Œä½¿ç”¨ä¸‹åˆ—æ–¹å¼æª¢æŸ¥ codeword æ˜¯å¦æ»¿è¶³ parityï¼š

```matlab
syndrome = mod(H * codeword, 2);
fprintf("\u2753 parity check failure: %d\n", sum(syndrome));
```

å¯¦éš›çµæžœï¼š

```
parity check failure: 8398
```

ä»£è¡¨ç·¨ç¢¼ç”¢ç”Ÿä¹‹ codeword ä¸¦ä¸åˆæ³•ï¼Œä¸¦æœªæ»¿è¶³ `H * cw = 0`ã€‚

---

## äº”ã€å˜—è©¦ä¿®æ­£èˆ‡é©—è­‰æ–¹å¼

ä»¥ä¸‹åˆ—å‡ºå¹¾é …æ›¾ç¶“å˜—è©¦éŽä½†ä»ç„¡æ•ˆçš„æ–¹å‘ï¼š

### 5.1 æª¢æŸ¥é„°æŽ¥è¡¨æ­£ç¢ºæ€§

ä½¿ç”¨ `check_neighbor_table_consistency()` æ¯”å° `H_expanded` èˆ‡ `cn_to_vn`, `vn_to_cn`ï¼š

```
âœ… é„°æŽ¥è¡¨èˆ‡ H éžé›¶å…ƒç´ æ•¸ä¸€è‡´ï¼ˆ798720 æ¢é‚Šï¼‰
âœ… cn_to_vn èˆ‡ vn_to_cn é…å°ä¸€è‡´ï¼Œé„°æŽ¥è¡¨æ­£ç¢ºï¼
```

çµè«–ï¼šé„°æŽ¥è¡¨çµæ§‹èˆ‡ H çŸ©é™£ä¸€è‡´ï¼Œå•é¡Œéžå‡ºæ–¼æ­¤ã€‚

### 5.2 Gray ç·¨ç¢¼èª¿è®Š

åŽŸå…ˆ QPSK mapping ä¸¦éž Gray é †åºï¼Œæœƒä½¿éŒ¯èª¤æ“´æ•£ã€‚å¾Œä¾†æ”¹ç‚ºï¼š

```matlab
symbol_map = [1+1j, -1+1j, -1-1j, 1-1j] / sqrt(2);
bit_decimal = bi2de(codeword_pairs, 'left-msb');
gray_index = bitxor(bit_decimal, floor(bit_decimal / 2)) + 1;
tx_symbols = symbol_map(gray_index).';
```

LLR è¨ˆç®—ä¹Ÿéœ€æ ¹æ“š gray\_bits é‡æ–°å°æ‡‰ï¼š

```matlab
gray_bits = [0 0; 0 1; 1 1; 1 0];
mask0 = gray_bits(:, b) == 0;
mask1 = gray_bits(:, b) == 1;
```

æ­¤æ”¹æ³•æå‡è§£ç¢¼æ­£ç¢ºæ€§ï¼Œä½†ç„¡æ³•è§£æ±ºæ ¹æœ¬å•é¡Œï¼ˆcodeword ä¸åˆæ³•ï¼‰ã€‚

### 5.3 åŠ å…¥ Offset èˆ‡ Dampingï¼ˆè§£ç¢¼å±¤é¢ï¼‰

å¯¦é©—ä¸­å˜—è©¦æ–¼ Min-Sum åŠ å…¥ Offset æˆ– Dampingï¼Œä½† BER ä»ç¶­æŒåœ¨ 0.91ï¼Œèªªæ˜Žå•é¡Œå‡ºåœ¨å‚³é€ç«¯ã€‚

---

## å…­ã€åˆ†æž ldpc\_encode\_neighbor() éŒ¯èª¤é‚è¼¯

```matlab
function codeword = ldpc_encode_neighbor(info_bits, cn_to_vn, N)
    K = length(info_bits);
    codeword = zeros(N, 1);
    codeword(1:K) = info_bits;

    for m = 1:length(cn_to_vn)
        idxs = cn_to_vn{m};
        parity = mod(sum(codeword(idxs)), 2);

        if parity ~= 0
            flipped = false;
            for j = 1:length(idxs)
                col = idxs(j);
                if col > K
                    codeword(col) = mod(codeword(col) + 1, 2);
                    flipped = true;
                    break;
                end
            end
            if ~flipped
                for j = 1:length(idxs)
                    col = idxs(j);
                    if col <= K
                        codeword(col) = mod(codeword(col) + 1, 2);
                        break;
                    end
                end
            end
        end
    end
end
```

æ­¤æ–¹æ³•é€å€‹ CN æ ¡é©— parityï¼Œè‹¥ä¸ç¬¦å‰‡ã€Œåè½‰å…¶ä¸­ä¸€å€‹ä½å…ƒã€ã€‚ä½†è©²æ–¹æ³•ä¸¦ç„¡ä¿è­‰æ‰€æœ‰ CN åŒæ™‚æ»¿è¶³ï¼Œåªæ˜¯å±€éƒ¨ä¿®æ­£ï¼Œå°Žè‡´æ•´é«”ä»ä¸åˆæ³•ã€‚

---

## ä¸ƒã€è¨ˆç•«æ”¹ç”¨ç³»çµ±å¼æ–¹å¼æŽ¨å°Žç·¨ç¢¼å™¨

å¾ŒçºŒé å®šæŽ¡å–ä»¥ä¸‹æ–¹æ³•ï¼š

1. ä½¿ç”¨ `H_expanded` å»ºç«‹ `H = [A | B]`ï¼Œå˜—è©¦é‡æŽ’ç‚º `H = [P | I]` çµæ§‹ã€‚
2. è‹¥æˆåŠŸï¼Œå‰‡å¯å°Žå‡º `G = [I | Páµ—]`ï¼Œä¸¦ç›´æŽ¥ä½¿ç”¨çŸ©é™£ä¹˜æ³•ç”¢ç”Ÿåˆæ³• codewordã€‚
3. é‡æ–°å»ºç«‹é„°æŽ¥è¡¨ï¼Œä»¥å°æ‡‰é‡æŽ’å¾Œçš„ Hã€‚
4. ç¢ºä¿ parity check å®Œå…¨æ­£ç¢ºå¾Œï¼Œå†é‡æ–°å›žåˆ°è§£ç¢¼æ¨¡çµ„é©—è­‰æ€§èƒ½ã€‚

---

**çµè«–ï¼šç›®å‰æœ€å¤§å•é¡Œå‡ºåœ¨ç·¨ç¢¼ç«¯ç”¢ç”Ÿä¹‹ codeword ä¸¦ä¸åˆæ³•ï¼Œæ‡‰å›žæ­¸åŽŸå§‹ H çŸ©é™£ï¼Œä»¥ç³»çµ±å¼æ–¹æ³•è¨­è¨ˆ encoderï¼Œç¢ºä¿ parity check æ­£ç¢ºã€‚**

# 2025/07/09 - LDPC æ¨¡æ“¬æµç¨‹ å¯¦ä½œèˆ‡é™¤éŒ¯ç´€éŒ„

## ä¸€ã€ç³»çµ±åˆ†å·¥èˆ‡æ¨¡çµ„åŒ–ç¨‹å¼æž¶æ§‹

æœ¬æ—¥å»¶çºŒ 7/7 æ¨¡æ“¬æµç¨‹ï¼Œé‡å° 5G NR LDPC Base Graph 1ï¼Œlifting size Z=384ï¼Œæ·±å…¥æŽ¢è¨Ž H çŸ©é™£çµæ§‹ï¼Œä¸¦å„ªåŒ–ç·¨ç¢¼æµç¨‹ã€‚æ¨¡æ“¬ç’°å¢ƒ MATLABã€‚  
æœ¬æ¬¡é‡é»žç‚ºæŽ’æŸ¥ H çŸ©é™£çµæ§‹éŒ¯èª¤ã€é„°æŽ¥è¡¨ç·¨ç¢¼æ­£ç¢ºæ€§åŠ parity é©—è­‰ã€‚

---

## äºŒã€ä»Šæ—¥è©³ç´°å·¥ä½œç´€éŒ„èˆ‡å¿ƒå¾—

### 2.1 ç³»çµ±ç”ŸæˆçŸ©é™£ G_sys ç·¨ç¢¼å˜—è©¦èˆ‡å•é¡Œ

- åˆæœŸå˜—è©¦ç”¨æ•¸å­¸ä¸Šå‚³çµ±ç³»çµ±aticç¢¼æ¦‚å¿µï¼Œå°‡ H æ‹†æˆå·¦åŠå–®ä½çŸ©é™£ I èˆ‡å³åŠçŸ©é™£ Pï¼Œåˆ©ç”¨  
  \[
  G_{sys} = [I, P^T]
  \]
  é€²è¡Œç·¨ç¢¼ã€‚  
- å¯¦å‹™ä¸Šå›  P éžæ–¹é™£ä¸”éžä¸€å®šå¯é€†ï¼Œä¸” 5G NR LDPC Base Graph çš„ H çŸ©é™£ç¨€ç–ä¸”çµæ§‹ç‰¹æ®Šï¼Œç„¡æ³•ç›´æŽ¥ç”¨æ­¤æ–¹æ³•ç·¨ç¢¼ã€‚  
- çµæžœ parity bits ç·¨ç¢¼ä¸æ­£ç¢ºï¼ˆéžå…¨ 0ï¼‰ï¼Œå°Žè‡´è§£ç¢¼å¤±æ•—ã€‚  
- é€™åæ˜ å‡º 5G NR LDPC çš„ H çŸ©é™£çµæ§‹èˆ‡å‚³çµ± LDPC ä¸åŒï¼Œå¿…é ˆç”¨æ›´è²¼è¿‘è¦ç¯„çš„æ–¹å¼ã€‚

### 2.2 é„°æŽ¥è¡¨ç·¨ç¢¼èˆ‡é»žåœ–è¦–è¦ºåŒ–ç™¼ç¾ç•°å¸¸

- ä½¿ç”¨é„°æŽ¥è¡¨ `cn_to_vn` åŠ `ldpc_encode_neighbor()` å‡½æ•¸é€²è¡Œç·¨ç¢¼ã€‚  
- åˆ©ç”¨ spy æˆ–é¡žä¼¼å‡½æ•¸ç¹ªè£½å±•é–‹å¾Œçš„ H çŸ©é™£é»žåœ–ï¼ˆè—é»žä»£è¡¨ 1ï¼‰ã€‚  
- èˆ‡[linkedin.com/pulse/5g-nr-dl-sch-ldpc-channel-coding-base-graph-](https://www.linkedin.com/pulse/5g-nr-dl-sch-ldpc-channel-coding-base-graph-selection-chelikani)æ–‡ç« çš„æ¨™æº–é»žåœ–æ¯”è¼ƒï¼Œç™¼ç¾å³åŠéƒ¨åˆ†ï¼ˆcol 23Z~67Zï¼‰ç¼ºä¹é€£æŽ¥é»žã€‚  
- æ­¤å•é¡Œæ„å‘³è‘—é„°æŽ¥è¡¨ä¸­ç¼ºå°‘æŸäº› parity check çš„ç´„æŸé‚Šï¼Œå°Žè‡´ parity è¨ˆç®—éŒ¯èª¤ã€‚

### 2.3 æ·±å…¥ H çŸ©é™£çµæ§‹åˆ†æžèˆ‡äº”éƒ¨åˆ†å€å¡Šç†è§£

- H çŸ©é™£å¯æ‹†åˆ†ç‚ºäº”å€‹å€å¡Šï¼š  
  1. å·¦ä¸Šè³‡è¨Šä½å…ƒå°æ‡‰å€ï¼ˆI çŸ©é™£å¡Šï¼‰  
  2. æ ¸å¿ƒ parity check å€ï¼ˆé›™å°è§’å¡Šï¼Œä¸»è¦æŽ§åˆ¶ parity ç´„æŸï¼‰  
  3. å³ä¸‹ parity bits å°æ‡‰çš„å–®ä½çŸ©é™£ï¼ˆ42 Ã— Zï¼‰  
  4. é„°æŽ¥è¡¨é€£æŽ¥æƒ…æ³ï¼ˆcn_to_vn é€£ç·šé—œä¿‚ï¼‰  
  5. Lifting size Z çš„ä¸€è‡´æ€§èˆ‡è¡Œåˆ—åŒ¹é…  
- ç™¼ç¾å³ä¸‹å–®ä½çŸ©é™£å€å¡Šç¼ºå¤±æ˜¯å°Žè‡´éŒ¯èª¤çš„ä¸»å› ã€‚

### 2.4 å˜—è©¦è£œé½Šå³ä¸‹å–®ä½çŸ©é™£å€å¡Š

- è£œä¸Šå³ä¸‹è§’ 42Ã—Z å–®ä½çŸ©é™£ä»¥è§£ parity bitsï¼Œå˜—è©¦é‡æ–°ç·¨ç¢¼ã€‚  
- Parity bits ä»éž 0ï¼Œä»£è¡¨å°šæœªåŒ…å«å…¨éƒ¨ parity æ¢ä»¶ã€‚

### 2.5 ç”¨çŸ©é™£åˆ†å¡ŠæŽ¨å°Ž parity bits å…¬å¼

- æŒ‰æ•¸å­¸ç†è«–ï¼Œä»¤ï¼š  
  \[
  H = [H_1, H_2], \quad codeword = [info\_bits, parity\_bits]
  \]
- parity bits å¯ç”¨ï¼š  
  \[
  parity\_bits^T = -H_2^{-1} H_1 info\_bits^T
  \]
- ä½† H_2 æ˜¯å¦å¯é€†ã€æ•¸å€¼æ¢ä»¶æ˜¯å¦ç©©å®šç‚ºç–‘å•ã€‚  
- å¯¦é©—ä¸­ parity è¨ˆç®—ä»ä¸ç­‰æ–¼ 0ã€‚

### 2.6 å†æ¬¡æ¯”å°æ¨™æº–é»žåœ–ï¼Œç™¼ç¾é›™å°è§’å€å¡Šéºæ¼

- åœ¨å®˜æ–¹åŠ LinkedIn åœ–ä¸­ï¼Œrow 0~4Z èˆ‡ col 22~26Z äº¤ç•Œè™•æœ‰é‡è¦é›™å°è§’çµæ§‹ï¼ˆshift=0 èˆ‡ shift=45ï¼‰  
- æœ¬åœ°å±•é–‹çŸ©é™£ä¸­ç¼ºä¹æ­¤çµæ§‹ï¼Œå°Žè‡´ parity ç´„æŸä¸å®Œæ•´ã€‚

### 2.7 è£œä¸Šé›™å°è§’å€å¡Šèˆ‡æœ€çµ‚é©—è­‰

- å°‡ç¼ºå¤±é›™å°è§’å€å¡Šè£œé½Šï¼Œç”Ÿæˆçš„ H_expanded é»žåœ–èˆ‡å®˜æ–¹è³‡æ–™ä¸€è‡´ã€‚  
---

## ä¸‰ã€å­¸ç¿’å¿ƒå¾—èˆ‡æŠ€è¡“ç¸½çµ

- **5G NR LDPC H çŸ©é™£çµæ§‹è¤‡é›œ**ï¼Œä¸èƒ½ç°¡å–®ç”¨å‚³çµ±ç³»çµ±aticç·¨ç¢¼æ³•ã€‚  
- **æ ¸å¿ƒé›™å°è§’ parity check çµæ§‹ä¸å¯å¿½ç•¥**ï¼Œæ˜¯ parity ç´„æŸå®Œæ•´æ€§çš„é—œéµã€‚  
- **é„°æŽ¥è¡¨çµæ§‹é ˆå®Œæ•´æ­£ç¢º**ï¼Œå°‘ä¸€æ¢é‚Šå°±å°Žè‡´ç·¨ç¢¼éŒ¯èª¤ã€‚  
- **é»žåœ–è¦–è¦ºåŒ–æ˜¯é™¤éŒ¯é‡è¦å·¥å…·**ï¼Œå¹«åŠ©å¿«é€Ÿå®šä½ç¼ºæ¼ã€‚  
- **çŸ©é™£åˆ†å¡ŠæŽ¨å°Žç†è«–å¯è¡Œï¼Œä½†å¯¦å‹™éœ€ç¢ºèªçŸ©é™£å¯é€†æ€§èˆ‡æ•¸å€¼ç©©å®šæ€§ã€‚**  
- **parity check bits åˆ†å¸ƒã€H çŸ©é™£ lifting å±•é–‹æ–¹å¼ã€é›™å°è§’çµæ§‹æ„ç¾©**ï¼Œå°æ•´é«”ç³»çµ±æ›´æ·±å…¥ç†è§£ã€‚  
- å¾ŒçºŒéœ€ç¹¼çºŒé©—è­‰ parity = 0 æ˜¯å¦åš´æ ¼æˆç«‹ï¼Œä¸¦å®Œæˆ Tx ç«¯æ•´åˆæ¸¬è©¦ã€‚
<img width="676" height="526" alt="image" src="https://github.com/user-attachments/assets/33215b34-544d-4699-8912-60107e66f6ce" />
